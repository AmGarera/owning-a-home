{% extends "base.html" %}
{% set active_page = "process" %}
{% import "_vars-process.html" as vars with context %}

{% block title %}Owning a Home: Know the Process{% endblock title %}

{% block content %}

{% set active_phase = get_document("journey", phase_name) %}

{% set query = queries.journey %}
{% set filter = 'parent:' + active_phase.id %}
{% set steps = query.search_with_url_arguments(size=100,q=filter) %}

<main class="know-the-process wrapper" id="main" role="main">
  <div>
 
    <section class="content_main">
      <div class="u-mb15">
        <a class="list_link jump-link jump-link__left jump-link__before" href="">
          Owning a Home
        </a>
      </div>
      
      <ul class="block process-nav process-nav__top list__unstyled">
        <li>
          Know the process
        </li>
          {% for item in vars.process_steps %}
              {% if item.slug == active_phase.slug %}
                  <li class="current-step">
                      <span>{{loop.index}}</span>{{item.title}}
                  </li>
              {% else %}
                  <li>
                      <a href="/owning-a-home/process/{{'' if item.slug == 'prepare' else item.slug}}">
                          <span class="nav-number circled">{{loop.index}}</span>{{item.title}}
                      </a>
                  </li>
              {% endif %}
          {% endfor %}
      </ul>
      
      <section class="overview content-l content-l__main">
          <div class="content-l_col content-l_col-5-8">
              {% if active_phase.title %}
              <h1>
                {% if active_phase.order %}
                    <span class="icon-round phase-number">{{active_phase.order|int}}</span>{% endif %}{{active_phase.title | safe if active_phase.title}}
              </h1>
              {% endif %}
              <p class="short-desc">{{active_phase.content | safe if active_phase.content}}</p>
          </div>
          <div class="content-l_col content-l_col-3-8">
              Img placeholder
          </div>
      </section>
      
      
      {% if active_phase.milestones %}
        <div class="block block__border-top block__padded-top block__padded-bottom block__flush-bottom milestones">
          <h3 class="char-icon char-icon__checked char-icon__branded-light">During this phase, you will:</h3>
          <ul class="content-l">
            {% for milestone in active_phase.milestones %}
            <li class="content-l_col content-l_col-1-3 short-desc">
              {{ milestone|safe }}
            </li>
            {% endfor %}
          </ul>
        </div>
      {% endif %}
      
      <div class="phase-data">
        <div class="{% if active_phase.tools %} content-l {% endif %}">
          
          {% if active_phase.tools %}
            <div class="tools-col">
              <section class="explore block block__bg block__padded-top ">
                  <h3 class="h6 u-mb15">Tools for this Phase</h3>
                  {% for tool in active_phase.tools %}
                    <div class="tool">
                      {% if tool.text %}
                        <p class="short-desc">{{tool.description}}</p>
                      {% endif %}
                      <a class="list_link jump-link jump-link__right" href="tool.url">
                        {{tool.text}}
                      </a>
                    </div>
                  {% endfor %}
              </section>
            </div>
          {% endif %}
          
          {% if steps|list|length %}
            <div class="{% if active_phase.tools %}steps-col{% endif %}">
              <section class="steps">
                <h1 class="h3">Action steps</h1>
                <div class="expandable-group" data-accordion="true">
                  {% for step in steps %}            
                    <div class="expandable expandable__padded">
                        <button class="expandable_header expandable_target">
                            <span class="expandable_header-left expandable_label">
                                {{step.title|safe}}
                            </span>
                            <span class="expandable_header-right expandable_link">
                                <span class="expandable_cue-open">
                                    <span class="u-visually-hidden">Show</span>
                                    <span class="cf-icon cf-icon-plus-round"></span>
                                </span>
                                <span class="expandable_cue-close">
                                    <span class="u-visually-hidden">Hide</span>
                                    <span class="cf-icon cf-icon-minus-round"></span>
                                </span>
                            </span>
                        </button>
                        <div class="expandable_content">

                          <div class="content-l content-l__main">

                            {% if step.content %}
                            <section class="content-l_col-2-3 content-l_col short-desc">
                              <p>
                              {{step.content|safe}}          
                              </p>
                            </section>
                            {% endif %}
                    
                            {% if step.key_tool %}
                            <section class="content-l_col-1-3 content-l_col block block__sub">
                              <h4 class="h6 u-mb10">
                                <span class="cf-icon cf-icon-attach"></span>&nbsp;Key tool
                              </h4>
                              <a class="jump-link jump-link__right" href="{{step.key_tool.url}}">
                                <span class="jump-link_text">{{step.key_tool.text}}</span>
                              </a>
                            </section>
                            {% endif %}

                          </div><!-- .content-l__main -->
                    
                  
                          {% if step.how_to_take_action %}
                          <section class="content-l__main content-l step">
                            <h1 class="content-l_col-1-4 content-l_col h6 u-mb10">
                              How to take action
                            </h1>
                            <article class="content-l_col-3-4 content-l_col ">                        
                            {{step.how_to_take_action|safe}}
                            </article>
                          </section>
                          {% endif %}
                  
                          {% if step.what_to_know %}
                          <section class="content-l__main content-l step">
                            <h1 class="content-l_col-1-4 content-l_col h6 u-mb10">
                              What to know
                            </h1>
                            <article class="content-l_col-3-4 content-l_col">                        
                            {{step.what_to_know|safe}}
                            </article>
                          </section>
                          {% endif %}
                  
                        </div>
                    </div>
               {% endfor %} 
               </div>
          
              </section>
            </div>
          {% endif %} 
        </div> 
      </div>
      
      <h4>Ready for more? Explore another phase in the mortgage process.</h4>
      
      <ul class="block process-nav process-nav__bottom list__unstyled">
          {% for item in vars.process_steps %}
              {% if item.slug == active_phase.slug %}
                  <li class="current-step">
                      <span class="nav-number circled">{{loop.index}}</span>{{item.title}}
                  </li>
              {% else %}
                  <li>
                      <a href="/owning-a-home/process/{{'' if item.slug == 'prepare' else item.slug}}" class="jump-link">
                          <span>{{loop.index}}</span>{{item.title}}
                      </a>
                  </li>
              {% endif %}
          {% endfor %}
      </ul>
    </section> <!-- /.content_main -->
  </div>
</main>

{% endblock %}
